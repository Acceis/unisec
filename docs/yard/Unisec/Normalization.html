<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Unisec::Normalization
  
    &mdash; Documentation by YARD 0.9.36
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Unisec::Normalization";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (N)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Unisec.html" title="Unisec (module)">Unisec</a></span></span>
     &raquo; 
    <span class="title">Normalization</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Unisec::Normalization
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Unisec::Normalization</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/unisec/normalization.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>Normalization Forms</p>


  </div>
</div>
<div class="tags">
  

</div>
  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="HTML_ESCAPE_BYPASS-constant" class="">HTML_ESCAPE_BYPASS =
          <div class="docstring">
  <div class="discussion">
    <p>HTML escapable characters mapped with their Unicode counterparts that will
cast to themself after applying normalization forms using compatibility mode.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code">{
  <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">&lt;</span><span style="color:#710">'</span></span> =&gt; [<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">﹤</span><span style="color:#710">'</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">＜</span><span style="color:#710">'</span></span>],
  <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">&gt;</span><span style="color:#710">'</span></span> =&gt; [<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">﹥</span><span style="color:#710">'</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">＞</span><span style="color:#710">'</span></span>],
  <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">&quot;</span><span style="color:#710">'</span></span> =&gt; [<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">＂</span><span style="color:#710">'</span></span>],
  <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">'</span><span style="color:#710">&quot;</span></span> =&gt; [<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">＇</span><span style="color:#710">'</span></span>],
  <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">&amp;</span><span style="color:#710">'</span></span> =&gt; [<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">﹠</span><span style="color:#710">'</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">＆</span><span style="color:#710">'</span></span>]
}.freeze</pre></dd>
      
    </dl>
  




  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#nfc-instance_method" title="#nfc (instance method)">#<strong>nfc</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Normalization Form C (NFC) - Canonical Decomposition, followed by Canonical Composition.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#nfd-instance_method" title="#nfd (instance method)">#<strong>nfd</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Normalization Form D (NFD) - Canonical Decomposition.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#nfkc-instance_method" title="#nfkc (instance method)">#<strong>nfkc</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Normalization Form KC (NFKC) - Compatibility Decomposition, followed by Canonical Composition.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#nfkd-instance_method" title="#nfkd (instance method)">#<strong>nfkd</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Normalization Form KD (NFKD) - Compatibility Decomposition.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#original-instance_method" title="#original (instance method)">#<strong>original</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Original input.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#nfc-class_method" title="nfc (class method)">.<strong>nfc</strong>(str)  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Normalization Form C (NFC) - Canonical Decomposition, followed by Canonical Composition.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#nfd-class_method" title="nfd (class method)">.<strong>nfd</strong>(str)  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Normalization Form D (NFD) - Canonical Decomposition.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#nfkc-class_method" title="nfkc (class method)">.<strong>nfkc</strong>(str)  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Normalization Form KC (NFKC) - Compatibility Decomposition, followed by Canonical Composition.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#nfkd-class_method" title="nfkd (class method)">.<strong>nfkd</strong>(str)  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Normalization Form KD (NFKD) - Compatibility Decomposition.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#replace_bypass-class_method" title="replace_bypass (class method)">.<strong>replace_bypass</strong>(str)  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Replace HTML escapable characters with their Unicode counterparts that will cast to themself after applying normalization forms using compatibility mode.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#display-instance_method" title="#display (instance method)">#<strong>display</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Display a CLI-friendly output summurizing all normalization forms.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#display_replace-instance_method" title="#display_replace (instance method)">#<strong>display_replace</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Display a CLI-friendly output of the XSS payload to bypass HTML escape and what it does once normalized in NFKC &amp; NFKD.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(str)  &#x21d2; nil </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Generate all normilzation forms for a given input.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#replace_bypass-instance_method" title="#replace_bypass (instance method)">#<strong>replace_bypass</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Instance version of <span class='object_link'><a href="#replace_bypass-class_method" title="Unisec::Normalization.replace_bypass (method)">Normalization.replace_bypass</a></span>.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(str)  &#x21d2; <tt>nil</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Generate all normilzation forms for a given input</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>str</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the target string</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


41
42
43
44
45
46
47</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/unisec/normalization.rb', line 41</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">initialize</span>(str)
  <span style="color:#33B">@original</span> = str
  <span style="color:#33B">@nfc</span> = <span style="color:#036;font-weight:bold">Normalization</span>.nfc(str)
  <span style="color:#33B">@nfkc</span> = <span style="color:#036;font-weight:bold">Normalization</span>.nfkc(str)
  <span style="color:#33B">@nfd</span> = <span style="color:#036;font-weight:bold">Normalization</span>.nfd(str)
  <span style="color:#33B">@nfkd</span> = <span style="color:#036;font-weight:bold">Normalization</span>.nfkd(str)
<span style="color:#080;font-weight:bold">end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="nfc-instance_method">
  
    #<strong>nfc</strong>  &#x21d2; <tt>String</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Normalization Form C (NFC) - Canonical Decomposition, followed by Canonical Composition</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>input normalized with NFC</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


24
25
26</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/unisec/normalization.rb', line 24</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">nfc</span>
  <span style="color:#33B">@nfc</span>
<span style="color:#080;font-weight:bold">end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="nfd-instance_method">
  
    #<strong>nfd</strong>  &#x21d2; <tt>String</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Normalization Form D (NFD) - Canonical Decomposition</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>input normalized with NFD</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


32
33
34</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/unisec/normalization.rb', line 32</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">nfd</span>
  <span style="color:#33B">@nfd</span>
<span style="color:#080;font-weight:bold">end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="nfkc-instance_method">
  
    #<strong>nfkc</strong>  &#x21d2; <tt>String</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Normalization Form KC (NFKC) - Compatibility Decomposition, followed by Canonical Composition</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>input normalized with NFKC</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


28
29
30</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/unisec/normalization.rb', line 28</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">nfkc</span>
  <span style="color:#33B">@nfkc</span>
<span style="color:#080;font-weight:bold">end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="nfkd-instance_method">
  
    #<strong>nfkd</strong>  &#x21d2; <tt>String</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Normalization Form KD (NFKD) - Compatibility Decomposition</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>input normalized with NFKD</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


36
37
38</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/unisec/normalization.rb', line 36</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">nfkd</span>
  <span style="color:#33B">@nfkd</span>
<span style="color:#080;font-weight:bold">end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="original-instance_method">
  
    #<strong>original</strong>  &#x21d2; <tt>String</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Original input</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>untouched input</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


20
21
22</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/unisec/normalization.rb', line 20</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">original</span>
  <span style="color:#33B">@original</span>
<span style="color:#080;font-weight:bold">end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="nfc-class_method">
  
    .<strong>nfc</strong>(str)  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Normalization Form C (NFC) - Canonical Decomposition, followed by Canonical Composition</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>str</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the target string</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>input normalized with NFC</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


52
53
54</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/unisec/normalization.rb', line 52</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#069">self</span>.<span style="color:#06B;font-weight:bold">nfc</span>(str)
  str.unicode_normalize(<span style="color:#A60">:nfc</span>)
<span style="color:#080;font-weight:bold">end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="nfd-class_method">
  
    .<strong>nfd</strong>(str)  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Normalization Form D (NFD) - Canonical Decomposition</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>str</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the target string</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>input normalized with NFD</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


66
67
68</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/unisec/normalization.rb', line 66</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#069">self</span>.<span style="color:#06B;font-weight:bold">nfd</span>(str)
  str.unicode_normalize(<span style="color:#A60">:nfd</span>)
<span style="color:#080;font-weight:bold">end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="nfkc-class_method">
  
    .<strong>nfkc</strong>(str)  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Normalization Form KC (NFKC) - Compatibility Decomposition, followed by Canonical Composition</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>str</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the target string</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>input normalized with NFKC</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


59
60
61</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/unisec/normalization.rb', line 59</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#069">self</span>.<span style="color:#06B;font-weight:bold">nfkc</span>(str)
  str.unicode_normalize(<span style="color:#A60">:nfkc</span>)
<span style="color:#080;font-weight:bold">end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="nfkd-class_method">
  
    .<strong>nfkd</strong>(str)  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Normalization Form KD (NFKD) - Compatibility Decomposition</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>str</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the target string</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>input normalized with NFKD</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


73
74
75</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/unisec/normalization.rb', line 73</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#069">self</span>.<span style="color:#06B;font-weight:bold">nfkd</span>(str)
  str.unicode_normalize(<span style="color:#A60">:nfkd</span>)
<span style="color:#080;font-weight:bold">end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="replace_bypass-class_method">
  
    .<strong>replace_bypass</strong>(str)  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Replace HTML escapable characters with their Unicode counterparts that will
cast to themself after applying normalization forms using compatibility mode.
Usefull for XSS, to bypass HTML escape.
If several values are possible, one is picked randomly.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>str</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the target string</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>escaped input</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


83
84
85
86
87
88
89</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/unisec/normalization.rb', line 83</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#069">self</span>.<span style="color:#06B;font-weight:bold">replace_bypass</span>(str)
  str = str.dup
  <span style="color:#036;font-weight:bold">HTML_ESCAPE_BYPASS</span>.each <span style="color:#080;font-weight:bold">do</span> |k, v|
    str.gsub!(k, v.sample)
  <span style="color:#080;font-weight:bold">end</span>
  str
<span style="color:#080;font-weight:bold">end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="display-instance_method">
  
    #<strong>display</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Display a CLI-friendly output summurizing all normalization forms</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>puts <span style="color:#036;font-weight:bold">Unisec</span>::<span style="color:#036;font-weight:bold">Normalization</span>.new(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\u</span><span style="color:#D20">{1E9B 0323}</span><span style="color:#710">&quot;</span></span>).display
<span style="color:#777"># =&gt;</span>
<span style="color:#777"># Original: ẛ̣</span>
<span style="color:#777">#   U+1E9B U+0323</span>
<span style="color:#777"># NFC: ẛ̣</span>
<span style="color:#777">#   U+1E9B U+0323</span>
<span style="color:#777"># NFKC: ṩ</span>
<span style="color:#777">#   U+1E69</span>
<span style="color:#777"># NFD: ẛ̣</span>
<span style="color:#777">#   U+017F U+0323 U+0307</span>
<span style="color:#777"># NFKD: ṩ</span>
<span style="color:#777">#   U+0073 U+0323 U+0307</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>CLI-ready output</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


111
112
113
114
115
116
117
118
119
120
121</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/unisec/normalization.rb', line 111</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">display</span>
  colorize = lambda { |form_title, form_attr|
    <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="background-color:hsla(0,0%,0%,0.07);color:black"><span style="font-weight:bold;color:#666">#{</span><span style="color:#036;font-weight:bold">Paint</span>[form_title.to_s, <span style="color:#A60">:underline</span>,
             <span style="color:#A60">:bold</span>]<span style="font-weight:bold;color:#666">}</span></span><span style="color:#D20">: </span><span style="background-color:hsla(0,0%,0%,0.07);color:black"><span style="font-weight:bold;color:#666">#{</span>form_attr<span style="font-weight:bold;color:#666">}</span></span><span style="color:#b0b">\n</span><span style="color:#D20">  </span><span style="background-color:hsla(0,0%,0%,0.07);color:black"><span style="font-weight:bold;color:#666">#{</span><span style="color:#036;font-weight:bold">Paint</span>[<span style="color:#036;font-weight:bold">Unisec</span>::<span style="color:#036;font-weight:bold">Properties</span>.chars2codepoints(form_attr), <span style="color:#A60">:red</span>]<span style="font-weight:bold;color:#666">}</span></span><span style="color:#b0b">\n</span><span style="color:#710">&quot;</span></span>
  }
  colorize.call(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">Original</span><span style="color:#710">'</span></span>, <span style="color:#33B">@original</span>) +
    colorize.call(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">NFC</span><span style="color:#710">'</span></span>, <span style="color:#33B">@nfc</span>) +
    colorize.call(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">NFKC</span><span style="color:#710">'</span></span>, <span style="color:#33B">@nfkc</span>) +
    colorize.call(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">NFD</span><span style="color:#710">'</span></span>, <span style="color:#33B">@nfd</span>) +
    colorize.call(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">NFKD</span><span style="color:#710">'</span></span>, <span style="color:#33B">@nfkd</span>)
<span style="color:#080;font-weight:bold">end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="display_replace-instance_method">
  
    #<strong>display_replace</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Display a CLI-friendly output of the XSS payload to bypass HTML escape and
what it does once normalized in NFKC &amp; NFKD.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


125
126
127
128
129
130
131
132
133
134
135</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/unisec/normalization.rb', line 125</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">display_replace</span>
  colorize = lambda { |form_title, form_attr|
    <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="background-color:hsla(0,0%,0%,0.07);color:black"><span style="font-weight:bold;color:#666">#{</span><span style="color:#036;font-weight:bold">Paint</span>[form_title.to_s, <span style="color:#A60">:underline</span>,
             <span style="color:#A60">:bold</span>]<span style="font-weight:bold;color:#666">}</span></span><span style="color:#D20">: </span><span style="background-color:hsla(0,0%,0%,0.07);color:black"><span style="font-weight:bold;color:#666">#{</span>form_attr<span style="font-weight:bold;color:#666">}</span></span><span style="color:#b0b">\n</span><span style="color:#D20">  </span><span style="background-color:hsla(0,0%,0%,0.07);color:black"><span style="font-weight:bold;color:#666">#{</span><span style="color:#036;font-weight:bold">Paint</span>[<span style="color:#036;font-weight:bold">Unisec</span>::<span style="color:#036;font-weight:bold">Properties</span>.chars2codepoints(form_attr), <span style="color:#A60">:red</span>]<span style="font-weight:bold;color:#666">}</span></span><span style="color:#b0b">\n</span><span style="color:#710">&quot;</span></span>
  }
  payload = replace_bypass
  colorize.call(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">Original</span><span style="color:#710">'</span></span>, <span style="color:#33B">@original</span>) +
    colorize.call(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">Bypass payload</span><span style="color:#710">'</span></span>, payload) +
    colorize.call(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">NFKC</span><span style="color:#710">'</span></span>, <span style="color:#036;font-weight:bold">Normalization</span>.nfkc(payload)) +
    colorize.call(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">NFKD</span><span style="color:#710">'</span></span>, <span style="color:#036;font-weight:bold">Normalization</span>.nfkd(payload))
<span style="color:#080;font-weight:bold">end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="replace_bypass-instance_method">
  
    #<strong>replace_bypass</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Instance version of <span class='object_link'><a href="#replace_bypass-class_method" title="Unisec::Normalization.replace_bypass (method)">replace_bypass</a></span>.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


92
93
94</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/unisec/normalization.rb', line 92</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">replace_bypass</span>
  <span style="color:#036;font-weight:bold">Normalization</span>.replace_bypass(<span style="color:#33B">@original</span>)
<span style="color:#080;font-weight:bold">end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Fri May 17 16:33:54 2024 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.36 (ruby-3.3.0).
</div>

    </div>
  </body>
</html>